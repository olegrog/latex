\documentclass{article}
\usepackage{a4wide}
\usepackage[english]{babel}

%%% functional packages
\usepackage{amssymb, mathtools, amsthm, mathrsfs}
\usepackage{framed}                % for leftbar
\usepackage[%
    font={bfseries},
    leftmargin=0.1\textwidth,
    indentfirst=false
]{quoting}

\usepackage{lipsum}
\usepackage{graphicx}
\def\asterism{\par\vspace{1em}{\centering\scalebox{1}{\bfseries *~*~*}\par}\vspace{.5em}\par}

\usepackage[
    backend=biber,
    style=numeric,
    sorting=none,
    maxbibnames=99, minbibnames=99,
    natbib=true,
    url=false,
    eprint=true,
    pagetracker,
    giveninits]{biblatex}
\bibliography{../dvm-lbm}

\title{Response to Reviewers' Comments}

\newcommand{\dd}{\mathrm{d}}
\newcommand{\pder}[2][]{\frac{\partial#1}{\partial#2}}
\newcommand{\pderdual}[2][]{\frac{\partial^2#1}{\partial#2^2}}
\newcommand{\pderder}[3][]{\frac{\partial^2#1}{\partial#2\partial#3}}
\newcommand{\Pder}[2][]{\partial#1/\partial#2}
\newcommand{\Pderdual}[2][]{\partial^2#1/\partial#2^2}
\newcommand{\Pderder}[3][]{\partial^2#1/\partial#2\partial#3}
\newcommand{\Set}[2]{\{\,{#1}:{#2}\,\}}
\newcommand{\OO}[1]{O(#1)}
\newcommand{\transpose}[1]{#1^\mathsf{T}}
\DeclarePairedDelimiter\autobracket()       % mathtools are needed
\newcommand{\br}[1]{\autobracket*{#1}}

% topic-specific
\newcommand{\dxi}{\dd{\boldsymbol{\xi}}}
\newcommand{\bxi}{\boldsymbol{\xi}}
\newcommand{\bpsi}{\boldsymbol{\psi}}
\newcommand{\bv}{\boldsymbol{v}}
\newcommand{\bq}{\boldsymbol{q}}
\newcommand{\bc}{\boldsymbol{c}}
\newcommand{\bn}{\boldsymbol{n}}
\newcommand{\be}{\boldsymbol{e}}
\newcommand{\bm}{\boldsymbol{m}}
\newcommand{\bT}{\boldsymbol{T}}
\newcommand{\bdot}{\boldsymbol{\cdot}}
\newcommand{\dx}{\dd{\boldsymbol{x}}}
\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\equil}[1]{#1^\mathrm{(eq)}}
\newcommand{\refer}[1]{#1_0}
\newcommand{\LB}{\mathrm{LB}\!}
\newcommand{\DV}{\mathrm{DV}\!}

\newcommand{\xiai}{\xi_{j \alpha}}
\newcommand{\xiaj}{\xi_{j \beta}}
\newcommand{\xiak}{\xi_{j \gamma}}
\newcommand{\cai}{c_{j \alpha}}
\newcommand{\caj}{c_{j \beta}}
\newcommand{\cak}{c_{j \gamma}}
\newcommand{\ai}{a_{\alpha}}
\newcommand{\aij}{a_{\alpha\beta}}
\newcommand{\aijk}{a_{\alpha\beta\gamma}}
\newcommand{\Hi}{H_{\alpha}}
\newcommand{\Hij}{H_{\alpha\beta}}
\newcommand{\Hijk}{H_{\alpha\beta\gamma}}

\begin{document}

\maketitle

We are grateful to the Reviewers for their very fruitful comments and suggestions.
Our answer and changes are presented below.
The reviewers' words are shown in bold.
Individual parts of the corrected version of the manuscript
can be recognized by the bold lateral line.

\section*{Referee report \#1}

\begin{quoting}
    1. It is not clear to me what this paper brings in addition to the work of Di Staso et al.
    Please, be specific on this point.
\end{quoting}

Ideologically, the present work is similar to the work of Di Staso et al. But there are significant
differences. The present paper introduces (in particular as a perspective) a hybrid approach by
means of DVM, keeping in mind that LB models have been created on the basis of the special
systems of regular discrete velocities. DSMC schemes is in fact of the other nature, they use the
stochastic (dynamically changed in the process of computation) system of discrete velocities.
This can in principle lead to the noise in the interface boundary. Of course, in our hybrid method
some important tasks of matching should be resolved.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    2. It would be very useful if the authors could comment a bit more specifically
    on the potential competitivity with DSMC for the problems they mention in the conclusions
    (supersonic, highly thermal, because this is the real issue at stake).
\end{quoting}

There are complex LB models with large numbers of discrete nodes fit to simulate supersonic
flows. In this case the near-continuum part of the region under consideration could be covered by
this LB model and in the narrow Knudsen layers DVM could be used. Then potentially this
hybrid method could be competitive with DSMC schemes.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    3. Please take a look at recent work of Aiguo Xu (soft matter, PRE) on DVM for
    thermal and multiphase non-equil flows. I think they belong and should be cited.
\end{quoting}

The references added to the text of the manuscript.

\begin{leftbar}
\end{leftbar}

\section*{Referee report \#2}

\begin{quoting}
    1. My greatest concern is related to the idea of coupling
    DVM with LB. Especially in the context of Couette flow,
    there are already published pure LB implementations which
    are significantly more efficient and even more accurate
    than the DVM employed in this paper. Thus, further
    motivation should be provided for introducing this scheme,
    perhaps by identifying a fundamental flaw of the LB approach,
    which mandates the use of DVM.
\end{quoting}

The presented method gives accurate results for the hydrodynamic quantites.
For instance, the longitudal velocity $v_x$ results for the hybrid method
are very close to the tabulated results for $k=0.1$ (Fig.~2).

Nevertheless, the longitudinal heat flux is not reproduced with a good precision.
This feature is anticipated. As was mentioned in the Comment, LB has fundamental flaws.
In the present case this flaw is inability of the applied LB models to reproduce the highest moments,
moreover LB models in the paper do not even reproduce fully thermohydrodynamics.

We should also emphasize that longitudinal heat flux in the Couette flow has nonequilibrium nature
and to our knowledge this flux can be observed if at least the Burnett equations are considered.
As a result, we need the LB model which is able
\begin{itemize}
    \item to reproduce Burnett thermohydrodynamics,
    \item to reproduce some lowest Maxwell half-moments.
\end{itemize}

\begin{leftbar}
\end{leftbar}

%%% TODO(olegrog): Some text in introduction that LB can advance beyond NS and takes into account some rarefied gas effects, however up to now does not provide universal tool for solution of the Boltzmann equation.

Finally, to be more specific on peculiarities of the VDF arised in boundary-value problems,
which cannot be correctly described by classical LB methods,
we have introduced the following subsection into the manuscript:
\begin{leftbar}
    \subsection*{Mesh refinement}
    The diffuse-reflection boundary conditions introduce several singularities into the VDF
    both in the velocity space and in the physical one.
    First, the discontinuity exists along the plane \(\bxi\bn=0\) and directly on the boundary surface (\(\bx=\bx_B\)).
    For a convex domain, this discontinuity does not penetrate into the gas region~\cite{Kim2011, Guo2017},
    since characteristics do not enter into the gas region.
    Nevertheless, sharp variations of the solution near \(\bxi\bn=0\) requires a strong mesh refinement
    in order to achieve a high-accuracy approximation.
    Moreover, it is necessary to resolve the logarithmic singularity of the form~\cite{Takata2016}
    \begin{equation}\label{eq:xi_singularity}
        \pder[f]{\bxi}\bdot\bn = C_1\log\bxi\bdot\bn + \OO{1}, \quad (\bxi\bdot\bn<0, \quad \bx=\bx_B).
    \end{equation}
    Second, another logarithmic singularity arises in the physical space along \(\bn\)~\cite{Takata2014}:
    \begin{equation}\label{eq:x_singularity}
        \pder[f]{\bx}\bdot\bn = \frac{C_2}{k}\log\frac{(\bx-\bx_B)\bdot\bn}{k} + \OO{1}.
    \end{equation}
    Here, \(C_1\) and \(C_2\) are some positive constants.
    It is seen from~\eqref{eq:x_singularity} that the logarithmic singularity of the VDF
    --- and all macroscopic variables as well --- takes place for all Knudsen numbers;
    however, for small \(k\), it becomes highly localized in the Knudsen layer.
    Therefore, the physical grid should be refined exponentially as \(\bx\) goes to \(\bx_B\).
\end{leftbar}

\begin{quoting}
    2. The coupling between the LB and DVM regions is not
    smooth, suggesting that the coupling procedure is not
    fully compatible with the idea of this multi-solver.
    In particular, is there any reason why the series in
    Eq. (13) is truncated at third order with respect to
    the Hermite polynomials? Can this coupling be improved?
    If it can, I recommend that a definitive implementation
    of the coupling is provided in this manuscript; otherwise,
    a convincing proof / argument should be provided why this
    coupling cannot be improved.
\end{quoting}

The non-smooth behavior is observed mostly for the longitudinal heat flux.
We need to emphasize that the matching of the heat flux is continuous
(the heat flux is the same for the BGK and LB at the matching interface)
and the jumps happen in the adjacent points
since LB is unable to reproduce the heat flux and distorts the heat flux profile.
These jumps in the heat flux show the limits of applicability of the method.
The longitudal heat flux $q_x$ is caused by the non-hydrodynamic effects
(potentially by the moments of all orders):
the part of the heat flux proportional to $k^2$ can be recovered at the Burnett level,
while the second part is attributable to the diffuse-reflection boundary conditions.
Therefore, the conventional LB models can not cope with $q_x$
(though isothermal D3Q96 can give qualitatively correct profile for the diffuse part).

As a result, we can conclude that the improvements in LB method should be directed
to the better reproduction of the highest Maxwell moments (Burnett level)
accompanied with the better reproduction of the wall moments.
The mapping method can be potentially improved with the involvement of the fourth-order moments
and the inclusion of the enhanced LB models.

Additional explanations are added to the Figure captions and to the text.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    3. The numerical results indicate that the ``special''
    7th order D3Q96 model performs better than the
    ``non-augmented'' models, even than the 9th order
    D3Q121 model. This improvement can be attributed to
    the half-range capabilities of the augmented models.
    Page 10 contains the remark that ``increasing order of
    the LB model [...] failed to describe its high-order
    relaxation correctly.'' - an important addition should
    be made here, namely that the higher order model is
    ``non-augmented.'' Does the quoted sentence hold when
    a higher order model which is augmented is employed?
\end{quoting}

Yes, the model D3Q121 is outperformed by D3Q96
since D3Q96 better reproduces the Maxwell half moments (or wall moment).
Moreover, one can say that the models with even number of velocities usually show better results
than the models with odd number of velocities.
The models with odd number velocities contains zero velocity in the lattice,
which has non-small lattice weight.
This lattice weight does not contribute in the Maxwell half moments
which in turn results in bad reproduction of the diffusive boundary condtitions.
In addition, zero velocity means that the model can have velocity directions parallel to the wall
which cause ``ballistic streamers'' problems.

Regarding the question, one can say that the straightforward increase of the quadrature order
(without consideration of the half-moment properties)
yields relatively slow convergence to exact results.
Here we can mention the paper~\cite{Meng2011accuracy},
where the plane Poiseuille flow was considered.
The Knudsen minimum was observed only for the D2Q4624 model (even velocity model)
with extremely high order quadrature.

Additional comments about ``augmentation property'' are added to the text of the paper.

\begin{leftbar}
Please, insert here, what was added to the paper.
\end{leftbar}

\begin{quoting}
    4. Fig. 5 indicates that the deviation norms are
    non-monotonous in the vicinity of the coupling
    interface - more strikingly on the DVM side of this
    interface. The interface essentially provides boundary
    conditions for the DVM, which are based on the
    full-range Hermite expansion of the Boltzmann
    distribution, given in Eq. (13). It can be seen that
    the augmented model provides a smoother transition than
    the non-augmented ones - this may be due to the
    half-range capabilities of the former. If this is
    the case, can a mapping at the level of a half-range
    expansion of the distribution be more appropriate?
\end{quoting}

...

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    5. In this paper, the advection is computed using
    the MCD flux limiter scheme. Is there any reason why
    a linear (first order) extrapolation given in
    Eq. (31) is preferred for the computation of the
    flux at the wall interface? Are there other viable
    extrapolation schemes available?
\end{quoting}

The linear extrapolation for the \emph{outflow} boundary conditions
does not violate the second-order approximation
and, actually, is the optimal choise for the current stencil.
Incidentally, zeroth-order extrapolation \(f_{M+1} = f_M\) yields
the first-order upwind scheme. It is well-known result from the FVM theory,
so we have restricted ourselves to addition of a couple of words
and the reference to the classical textbook~\cite{LeVeque2002}.

Moreover, we have rewritten subsection ``Finite-volume formulation'' completely
in order to improve the description and, hopefully, avoid other possible ambiguities.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    6. The numerical scheme presented in Sec.~5.1 is
    second order by design. Is this order preserved
    when boundary conditions are imposed? In particular,
    can second order convergence be proven with respect
    to the benchmark solution?
\end{quoting}

The presented numerical scheme has the second-order approximation by design,
including the boundary conditions.
However, the referee turns out to be correct that our scheme demonstrated the first-order approximation
on the boundary, which can be observed in Fig.~4 of the previous version of the manuscript,
where the numerical error increases significantly in the vicinity of the diffuse-reflection boundary.
The origin of the approximation loss was in inaccurate formula for \(f^n_0\).
Now, we have inserted the correct one and recomputed all data presented in figures.
It is worth noting that the additional numerical error introduced previously is rather small
due to strong mesh refinement near the boundary. It is possible to observe the difference
in the results only in Fig.~5 of the current version of the manuscript.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    7. At the coupling, it can be seen that the
    macroscopic profiles exhibit jumps. Are the
    amplitudes of these jumps affected by the spatial
    discretisation? If they remain finite as the
    mesh is refined, the stationary state displays
    a standing discontinuity, which clearly is not
    present in the solution of the kinetic equation -
    this point should be addressed. Also, the stability
    of the scheme should be discussed in this context,
    e.g. by checking if there exists a maximum
    resolution after which the scheme becomes unstable.
\end{quoting}

Yes, the the longitudinal heat flux results exhibit oscillation behavior
(the other low-order moments are smooth). As was mentioned before,
this is due to the inability of the present LB models to reproduce this moment correctly.
This effect does not disappear when the mesh is refined and does not affect the stability.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    8. Results should be presented for larger values of
    $k$. The numerical results indicate that the
    discontinuity between the LB and DVM regions increases
    with $k$. Is there a maximum value of $k$ for which
    the scheme is stable?
\end{quoting}

Results for $k=0.3$ are included in the manuscript.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    9. Can the scheme be employed for higher Mach number flows?
\end{quoting}

The limitations on the Mach number for the present scheme are attributed to the applied LB models.
Formally the applied high-order LB models (which describe correctly isothermal hydrodynamics correctly)
are applicable for non-negligible Mach numbers if for such flows the equilibrium remains non-negative,
the flow is isothermal.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    10. There are insufficient details regarding the scheme
    the results to be reproduced - in particular, it is not
    clear how the flux rescaling in Eq. (34) works, i.e. on
    which interfaces it is applied, and whether this affects
    the order of the numerical scheme. In my opinion, the
    readers will benefit from a short summary of the main
    steps, while ensuring that the scheme can be implemented
    based on the details provided in the manuscript.
\end{quoting}

The correction of fluxes according to Eq. (34) is performed in the interface
between the regions where DVM and LBM are applied.
About the influence of this correction on the accuracy of the numerical scheme.
The correction of the fluxes inserts the addition error,
this error depends on the flux related to the accuracy in coordinate space.
But it is easy to see that the relative error in this correction
depends on only the character of the system of discrete velocities,
i.e. on the accuracy in velocity space.
So the total error due to the correction depends on both coordinate and velocity accuracy.
Therefore the convergence of the numerical solution should be realized in the consistent manner,
namely when both steps in coordinate and velocity spaces tend to zero.
Now the main stages of the algorithm are emphasized in the new variant of the paper.

\begin{leftbar}
\end{leftbar}

\begin{quoting}
    11. Results obtained in the linearised regime are
    reported for the longitudinal heat flux. Since this
    quantity is not covered in Ref.~\cite{Luo2016}, an important
    appendix should be added, detailing the main steps
    taken in deriving these results.
\end{quoting}

...

\begin{leftbar}
\end{leftbar}

\printbibliography

\end{document}

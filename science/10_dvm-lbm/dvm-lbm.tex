%&pdflatex
\documentclass[]{elsarticle} %review
\journal{Journal of Statistical Mechanics: Theory and Experiment}

\pdfoutput=1

\usepackage[english]{babel}

%%% functional packages
\usepackage{amssymb, mathtools, amsthm, mathrsfs}
\usepackage{subcaption}
\usepackage{graphicx}
\graphicspath{{pics/}}

%%% configuration packages
\usepackage{fullpage}
%\usepackage{comment}

\usepackage{xcolor}
\newcommand{\todo}[1]{\textcolor{olive}{#1}}
\newcommand{\alert}[1]{\textcolor{red}{\large \bf #1}}

%\usepackage{lineno}
%\modulolinenumbers[5]

\usepackage[
    colorlinks,
]{hyperref}

\journal{Journal of \LaTeX\ Templates}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
%\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

% general
\newcommand{\Kn}{\mathrm{Kn}}
\newcommand{\Ma}{\mathrm{Ma}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\pder}[2][]{\frac{\partial#1}{\partial#2}}
\newcommand{\pderdual}[2][]{\frac{\partial^2#1}{\partial#2^2}}
\newcommand{\pderder}[3][]{\frac{\partial^2#1}{\partial#2\partial#3}}
\newcommand{\Pder}[2][]{\partial#1/\partial#2}
\newcommand{\Pderdual}[2][]{\partial^2#1/\partial#2^2}
\newcommand{\Pderder}[3][]{\partial^2#1/\partial#2\partial#3}
\newcommand{\Set}[2]{\{\,{#1}:{#2}\,\}}
\newcommand{\OO}[1]{O(#1)}
\newcommand{\transpose}[1]{#1^\mathsf{T}}
\DeclarePairedDelimiter\autobracket()       % mathtools are needed
\newcommand{\br}[1]{\autobracket*{#1}}

% topic-specific
\newcommand{\dxi}{\boldsymbol{\dd\xi}}
\newcommand{\bxi}{\boldsymbol{\xi}}
\newcommand{\bv}{\boldsymbol{v}}
\newcommand{\bq}{\boldsymbol{q}}
\newcommand{\bc}{\boldsymbol{c}}
\newcommand{\bn}{\boldsymbol{n}}
\newcommand{\bxia}{\bxi_j}
\newcommand{\dx}{\boldsymbol{\dd{x}}}
\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\xiai}{\xi_{j \alpha}}
\newcommand{\xiaj}{\xi_{j \beta}}
\newcommand{\xiak}{\xi_{j \gamma}}
\newcommand{\cai}{c_{j \alpha}}
\newcommand{\caj}{c_{j \beta}}
\newcommand{\equil}[1]{#1^\mathrm{(eq)}}
\newcommand{\refer}[1]{#1_0}

\begin{document}

\begin{frontmatter}

\title{Kinetic multiscale scheme based on the discrete-velocity and lattice-Boltzmann methods}

\author[ccas]{V.V.~Aristov}

\author[ccas]{O.V.~Ilyin}

\author[skoltech,ccas]{O.A.~Rogozin\corref{cor}}
\ead{oleg.rogozin@phystech.edu}
\cortext[cor]{Corresponding author}


\address[ccas]{Dorodnicyn Computing Center,
    Federal Research Center "Computer Science and Control" of Russian Academy of Science, Moscow, Russia}
\address[skoltech]{Center for Design, Manufacturing, and Materials,
    Skolkovo Institute of Science and Technology, Skolkovo, Russia}

\begin{abstract}

A novel hybrid computational method based on the discrete-velocity (DV) approximation including the lattice-Boltzmann (LB) technique is proposed.
Numerical schemes for the kinetic equations are used in regions of rarefied flows and LB schemes are employed in continuum flow zones.
Both of them are written under the finite-volume (FV) formulation to achieve flexibility of local mesh refinement.
The expansion to the Hermite polynomials is used for the coupling of DV and LB solutions.
A special attention is paid to the recent high-order LB models.
The linear Couette-flow problem is investigated as a numerical example,
where the good correspondence with the benchmark solution is obtained.

%In the present paper, a novel hybrid fluid--kinetic computational approach based on the discrete-velocity (DV) approximation including lattice-Boltzmann (LB) technique is proposed. Numerical schemes for a kinetic equation are used in regions of rarefied flows and LB schemes are used in continuum flow zones. The problem devoted to matching solutions of DV and LB in buffer cells is solved using the expansion of the solutions of DV and LB models on Hermite polynomials and matching the expansion coefficients.  A special attention is paid to the recent high-order LB models. Some variants of LBM are considered and the efficiency of the hybrid method is evaluated.  The Couette-flow problem is investigated as a test. The criteria transformation from the continuum region to kinetic one is proposed and the influence of the point transformation is studied. The CPU times for the hybrid scheme and for BGK scheme are compared. The good correspondence with the benchmark solution is obtained: the computations on the basis of the hybrid method are close to the well-known tabulated solutions of the Couette flow.




\end{abstract}

\begin{keyword}
%kinetic--kinetic coupling,
%kinetic multiscale scheme,
hybrid numerical method,
discrete-velocity method,
lattice-Boltzmann method,
domain decomposition,
rarefied and continuum flows.
\end{keyword}

\end{frontmatter}

%\linenumbers

\section{Introduction}\label{sec:intro}

%%% Effective numerical methods for multiscale problems
So far, effective numerical simulation of multiscale flows is the challenging problem despite the efforts of many researchers.
This is due, in particular, to complicated flow structures where small-scale highly nonequilibrium regions
coexist with large-scale equilibrium zones.
The use of the kinetic equation in all regions is very consuming from the computational point of view.
On the other hand, the modern approaches including the LB method is a profitable tool for description near-equilibrium flows,
but it is not adequate for regions where the velocity distribution function (VDF) is not close to Maxwellian
and the contribution of highest moments can not be ignored.
So the computational hydrodynamics is being confronted with an issue of constructing the unified numerical methods
suitable for simulation of multiscale flows.
% The numerical solution of kinetic equations in stiff regimes represents a challenge in the construction of computational methods.
% one would like to avoid the expensive cost of solving the kinetic equation in regions well described by continuum fluid models,
% since the latter are easily solvable by classical numerical methods.
% Therefore, to strike a balance between computational costs and simulation accuracy,
% multiscale schemes are being developed that take advantage of both kinetic and continuum-fluid solvers,
% i.e., deploying a kinetic solver only in the rarefied flow regions and a continuum solver in the hydrodynamic regions.

%%% Hybrid schemes
There are two main approaches how to deal with the multiscale problems (see, e.g., review~\cite{Dimarco2014}).
The first one employs different kinds of representations for equilibrium and non-equilibrium parts of the solution
in the entire computational space, while the second one handles the problem by dividing the physical domain
into the highly rarefied and near-equilibrium regions using some criterion of domain decomposition.
The fluid--kinetic coupling is a natural and effective approach for the description of multiscale flows.
The coupling of the Boltzmann and Euler or Navier--Stokes (NS) equations
is one of canonical example of such hybrid schemes (see, e.g.,~\cite{Bourgat1996, Tallec1997})
and has been also elaborated and applied within the UFS (Unified Flow Solver) framework~\cite{Kolobov2007}.
%1. Asymptotic-preserving schemes
%2. Dynamic domain decomposition strategies
%    A. Dynamic fluid--kinetic coupling methods:
%        a) A moving interface method: a stationary smooth transition strategy was proposed for this coupling.
%        b) A micro–macro moving interface method (Degond et al. 2010): micro–macro decomposition of the VDF
%3. Hybrid methods
%    A. Low-variance deviational Monte Carlo methods
%    % Variance reduction methods are a popular way to improve the accuracy of Monte Carlo methods by reducing the amount of fluctuations in the results (Caflisch 1998).
%    B. Moment-guided Monte Carlo methods
%    % The basic idea described here consists in obtaining reduced-variance Monte Carlo methods by forcing the statistical samples to match prescribed sets of moments given by the solution of deterministic macroscopic fluid equations (Degond et al. 2011, Dimarco 2013).
%    C. Hybrid multiscale methods (hybrid representation of the solution)
%    % different kind of representation of the solution as an equilibrium and non-equilibrium part, first introduced in Pareschi and Caflisch (1999).
%    % the solution in each cell is represented as a combination of two different parts, a stochastic particle representation of the non-equilibrium fraction and a deterministic representation of the equilibrium part

%%% Kinetic-based description of continuum media
We consider very briefly development and realization of these important ideas.
The kinetic-based description of continuum media has been suggested independently and has been widely used since the beginning of 80s,
see~\cite{Potkin1975, Pullin1980, Reitz1981, Aristov1983}. Later these kinetic-consistent schemes have been developed
in~\cite{Elizarova1985, Deshpande1986, Prendergast1993, Chou1997, Ohwada2004Xu, Ohwada2004Kobayashi, Ohwada2006}.
Such methods reproduce the Euler and NS dynamics.
The cellular-automata approximation for the NS equations was developed in the middle of 80s~\cite{Frisch1986}.
Finally, the lattice-gas model based on the BGK equation was proposed in the beginning of 90s~\cite{Qian1992}.
It gave rise to a wide class of numerical methods called lattice-Boltzmann (LB) methods~\cite{Succi2001}.

%%% Connection between DV and LB
It is worth to emphasize that the LB method is based, in fact, on some models of the DV method.
There are obvious relations between these two methods. For instance, one can cite a phrase from~\cite{Rivet2001}:
''This type of discrete kinetic theory can be seen as the ancestor of the lattice gas approach''.
The LB method is genetically related to the Broadwell-type models~{\cite{Broadwell1964shock, Gatignol1975},
which use a small number of discrete velocities to caricature the Boltzmann dynamics.
Thus the DV approximation is a natural basis for construction a hybrid multiscale model.

%%% Known coupling schemes for LB
The mapping scheme for coupling of the solutions for low-order and high-order LB models is presented in \cite{Meng2011},
while the possibility of merging the DV and LB methods was noticed in \cite{Succi2016}.
The methods of DSMC type in the kinetic zones and the Euler or NS equations in the continuum are well developed now,
but the usual statistical modeling in the buffer zone yields some statistical noise especially for subsonic flows, which complicates calculations.
This hybrid approach has been suggested in~\cite{Staso2016short, Staso2016long} and in the recent paper~\cite{Staso2018},
where the solution is obtained by means of coupling the DSMC and LB methods.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% NB: the following paragraph commented out was written by Ilyin in section "Main equation".
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%We adopt the domain decomposition procedure for solving the boundary-value problems for rarefied gas dynamics.
%Commonly the non-equilibrium effects in flows appear near boundaries;
%therefore, the boundary regions are described with the BGK model, while the internal zone is describe with the lattice BGK (LBGK).
%Previously, the approach based on solving the gas dynamics with DSMC method and LBGK models using domain decomposition
%was presented in~\cite{Staso2016short, Staso2016long, Staso2018}, where the Couette and Poiseuille flow were considered.
%Nevertheless, LB-DSMC coupling leads to appearance of some noise~\cite{Succi2016}, while LB-BGK coupling does not have this problem.

%%% Why DV is better than DSMC?
Unlike DSMC, the methods of direct numerical solution of the Boltzmann equation do not give a statistical noise of macroscopic parameters.
Therefore, hybrid methods based on a direct numerical solution of the Boltzmann equation appear to be more promising.
The DV schemes with the large number of discrete velocities are used in direct methods for solving BE, BGK, S-model or other kinetic equations.
The DV method is applied with the combination of Monte Carlo or quasi-Monte Carlo procedures for evaluating collision integrals
and for computing the appropriate moments which are used in the collision integrals of the model kinetic equations.
For the near-equilibrium zones, the small number of discrete velocities can be considered.
Therefore, one can expect that LB approaches are fit for describing flows in these regions.

%%% Our proposition
A novel hybrid kinetic approach for multiscale problems is proposed in the present paper.
We attempt to couple DV method for the Boltzmann equation (or its BGK model) and LB method for the NS equations.
The first one adequately describes nonequilibrium regions, while the second one provides an adequate description in continuum-flow regions.
At the boundaries of the BGK and LBGK domains the coupling method is applied.
For mapping we assume that in the overlapping zone of the two methods the VDF takes the form of the truncated Hermite expansion.
We employ several LB models including high-order lattices \cite{Shan2006, Feuchter2016}.
The hybrid DV-LB method is tested for the plane Couette flow and the excellent correspondence with previous results has been achieved.
No any additional regularization procedures \cite{Latt2006, Mont2015} for LB method are needed
since LB covers the spatial domain where the VDF is close to equilibrium.
In the mapping domain the LB VDF is equivalent to the Grad expansion via Gauss--Hermite quadrature.
Similar approach of mapping has been suggested in~\cite{Staso2016short, Staso2016long, Staso2018}.

%%% FV formulation
Classical LB methods enjoy their efficiency from highly symmetric discrete physical space and time
with respect to the discretization of the velocity space.
However, uniform Cartesian grids lack flexibility and, therefore, local grid refinement.
There are several approaches how to work around this limitation.
The LB method is easily extended for arbitrary unstructured meshes
under the FV formulation~\cite{Succi1992, Peng1999, Patil2009, Li2016}.
In the present paper, we adopt this strategy, in particular, to refine mesh near the boundary.

%%% Plan of the paper
The plan of the present paper is as follows.
The employed kinetic equations and nondimensional variables are introduced in Section~\ref{sec:equations}.
The mapping scheme is described in Section~\ref{sec:mapping}.
Details of numerical methods are presented in Section~\ref{sec:numerics}.
Section~\ref{sec:results} contains the numerical solutions of the Couette-flow problem
obtained by the BGK model, different LB models, and the hybrid scheme.
The efficiency of the hybrid approach is studied.
In section~\ref{sec:summary}, perspectives of DV-LB hybrid methods are discussed.

\section{Main equations}\label{sec:equations}

%%% VDF and macroscopic variables
In the present paper we will consider two kinetic models based on the nonlinear Boltzmann equation which will be used in our further computations.
Our main object is the Bhatnagar-Gross-Krook (BGK) kinetic model~\cite{Krook1954, Welander1954},
which takes the following nondimensional form:
\begin{equation}\label{eq:bgk}
    \pder[f]{t} + \bxi\pder[f]{\bx} = \frac1\tau\br{\equil{f}-f}, \quad
    \equil{f} = \frac{\rho}{(2\pi T)^{3/2}}\exp\br{ -\frac{(\bxi-\bv)^2}{2T} },
\end{equation}
where $f(t,\bx,\bxi)$ is the VDF of a dilute gas, $\tau$ is dimensionless relaxation time
(which equals to average number of collisions per particle until relaxation)
assumed to be constant in the present study, $\rho,\bv,T$ are density, bulk velocity, and temperature, respectively.
We also denote the stress tensor and heat flux as $p_{\alpha \beta}, \bq$.
All these quantities are defined as
\begin{equation}\label{eq:macro}
    \begin{gathered}
    \rho = \int f \dxi, \quad
    \bv = \frac1{\rho} \int \bxi f \dxi, \quad
    T = \frac{1}{3\rho}\int(\bxi-\bv)^2f \dxi = \frac{p_{ii}}{3\rho}, \\
    p_{\alpha \beta} = \int(\xi_{\alpha}-v_{\alpha})(\xi_{\beta}-v_{\beta}) f \dxi, \quad
    \bq = \frac{1}{2}\int(\bxi-\bv)(\bxi-\bv)^2 f \dxi.
    \end{gathered}
\end{equation}
The Knudsen number is \(\Kn = 2\tau/\sqrt\pi\).

%%% Why BGK model?
Formally, the nonlinearity in the BGK model is more severe than in the Boltzmann equation since $\equil{f}$ depends on $f$
via the moments $\rho,\bv,T$, but the BGK model is simpler for the numerical study.
The BGK equation is capable to reproduce strongly non-equilibrium effects in a dilute gas.

%%% Boundary conditions
The gas--surface interaction is described via the diffuse-reflection boundary conditions:
\begin{equation}\label{eq:diffuse}
    f(t,\bxi) = \br{-2\sqrt\frac\pi{T_B} \int_{\bxi'\bn<0}\bxi'\bn f(t,\bxi')\dxi'}
        \equil{f}(\bxi,1,\bv_B,T_B) \quad (\bxi\bn>0),
\end{equation}
where \(\bn\) is the unit vector normal to the boundary, directed into gas.
\(T_B\) and \(\bv_B\) are the boundary temperature and velocity, respectively.
It is also assumed that \(\bv_B\bn = 0\).

The LB method is the special discretization of the BGK model~\cite{Succi2001}.
We assume that the considered flow is isothermal and slow, i.e., the Mach number is close to zero.
Then we can expand the local Maxwell term into the Taylor series of the bulk velocity $\bv$ (or into the Hermite polynomials)
up to the terms of some finite order (at least, second).
Moreover, we assume that the particle can travel with the velocities $\bc_{j}, j=1 \ldots N$ from a finite discrete set of possible velocities
and the values of absolute Maxwellian are changed by the lattice weights $w_j$.
Finally the general LB model is obtained by the finite difference integration of the BGK equation on the characteristics,
the third-order expansion in $\bv$ yields the following local equilibrium LB state:
\begin{equation}\label{lbgk}
    \equil{f}_\mathrm{LB} = \rho w_j\left(1+ \frac{\bc_j\bv}{c_s^2}+\frac{(\bc_j\bv)^2-c_s^2v^2}{2c_s^4}
    + \frac{(\bc_j\bv)^3-3c_s^2 v^2(\bc_j\bv)}{6c_s^6}\right), \quad j=1,\ldots,N,
\end{equation}
where $\bc_j$ are the lattice velocities, $c_s$ is the sound velocity defined by $\sum_jw_j\bc^2_j=c_s^2$,
$\tau$ is the relaxation time, $N$ is the number of the lattice velocities.
In the case of the low-order lattices, like D3Q19, the third-order terms are truncated in \eqref{lbgk}.
We apply the kinetic boundary conditions (diffuse reflection)~\cite{Ansumali2002} for LB models in the present paper.

Several approaches can be applied for the construction of the LB models like Gauss--Hermite~\cite{He1997, Shan1998, Shan2006, Shan2010}
and the entropic method~\cite{Karlin1999, Chikatamarla2006, Chikatamarla2009}.

\section{The mapping method}\label{sec:mapping}

We will introduce the mapping method in the spatial overlapping zone of the BGK and LB models.
First of all, we assume that in this domain the VDF of the gas is close to the Maxwell state with zero bulk velocity and unit temperature.
Therefore, it can be represented in the form of the truncated Grad expansion up to the third order terms on the velocity
\begin{equation}\label{grad}
    f_H(\bx,\bxi) = \omega(\bxi)\left(a(\bx) +\sum_{\alpha}a_{\alpha}(\bx)H_{\alpha}+\frac{1}{2!}\sum_{\alpha\beta}a_{\alpha \beta}(\bx)H_{\alpha\beta}+\frac{1}{3!}\sum_{\alpha\beta \gamma}a_{\alpha\beta\gamma}(\bx)H_{\alpha\beta\gamma}\right),
\end{equation}
where $H_{\alpha}, H_{\alpha\beta}, H_{\alpha\beta\gamma}$ are the Hermite polynomials of the first, second, and third order defined by
$$
H_\alpha(\bxi)=\frac{(-1)}{\omega(\bxi)}\frac{\partial}{\partial \xi_\alpha}\omega(\bxi),  \quad H_{\alpha\beta}(\bxi)=\frac{1}{\omega(\bxi)}\frac{\partial^2}{\partial \xi_\alpha\partial \xi_\beta}\omega(\bxi),
\quad H_{\alpha\beta \gamma}(\bxi)=\frac{(-1)}{\omega(\bxi)}\frac{\partial^3}{\partial \xi_\alpha\partial \xi_\beta \partial \xi_\gamma}\omega(\bxi),
$$
and
$$
 \omega(\bxi)\equiv \frac{1}{\sqrt{(2\pi})^3}\exp\left(-\frac{\bxi^2}{2}\right).
$$
 The terms $a, a_{\alpha},a_{\alpha\beta}, a_{\alpha\beta \gamma}$ are coefficients depending on $\bx$ (the point in the overlapping domain).
 We will use the function \eqref{grad} for the transfer of the data between the LB and the BGK models. We will discuss this procedure in turn.

For the sake of clarity we assume that the flow depends not on the whole vector $\bx$ but on one of the coordinates only, we denote it by $x$.

At the first step we update the DV VDF $f_\mathrm{DV}(x,\bxi)$ for the discrete velocities $\bxi_n$ such that $(\bxi_n,\mathbf{e})<0$ , where $\mathbf{e}$ is the outer normal to overlapping domain,  starting from the wall spatial nodes and moving towards the overlapping zone.
In the spatial domain (physical domain) where the DV method overlaps the LB method we map the DV VDF for the DV difference scheme on the Grad VDF by calculating the following coefficients $a, a_\alpha,a_{\alpha\beta}, a_{\alpha\beta \gamma}$
$$
a(x)=\sum_{m=1}^M f_\mathrm{DV}(x,\bxi_m),   \quad a_\alpha(x)=\sum_{m=1}^Mf_\mathrm{DV}(x,\bxi_m)H_j(\bxi_m),
$$
$$
a_{\alpha\beta }(x)=\sum_{m=1}^Mf_\mathrm{DV}(x,\bxi_m)H_{\alpha\beta}(\bxi_m), \quad
a_{\alpha\beta \gamma}(x)=\sum_{m=1}^Mf_\mathrm{DV}(x,\bxi_m)H_{\alpha\beta \gamma}(\bxi_m),
$$
where $\bxi_m, m=1 \ldots M$ are velocities for DV difference scheme.
The Grad VDF \eqref{grad} is recovered in the overlapping spatial domain.

Next we will map the velocity distribution \eqref{grad} on the LB distribution using the Gauss--Hermite quadrature method.
The idea of the method is based on the fact that the representation of the VDF in the Grad form
is equivalent to the LB method~\cite{He1997, Shan1998, Shan2006}.
We consider the first moments $a,a_{\alpha},a_{\alpha\beta}, a_{\alpha\beta \gamma}$ in the integral form and then calculate them using Gauss--Hermite quadratures
$$
\{ a,a_{\alpha},a_{\alpha\beta}, a_{\alpha\beta \gamma} \}=\int f_H(\bxi)\{1,H_{\alpha}, H_{\alpha\beta} ,H_{\alpha\beta \gamma}\}(\bxi)d\bxi=\sum_{j=1}^N w_j\frac{f_H(\boldsymbol{c}_j)}{\omega(\bc_j)}
\{1,H_{\alpha}(\bc_j),H_{\alpha\beta}(\bc_j), H_{\alpha\beta\gamma}(\bc_j) \},
$$
where $w_j, \boldsymbol{c}_j$ are the weights and the nodes of the Gauss--Hermite quadrature respectively. The nodes $\bc_j$ can be considered as the LB velocities while $ w_j\frac{f(\bc_j)}{\omega(\bv_j)}$ are the LB VDF values and
$w_j$ are the lattice analog of the Maxwell distribution.  Then the formula
\begin{equation}\label{grad_to_latt}
f_{\mathrm{LB},j}\equiv w_j\frac{f_H(\bc_j)}{\omega(\bc_j)}
\end{equation}
gives the mapping from the Grad truncated VDF $f_H$ to the LB VDF $f_{LB,j}$ for the corresponding velocities $\bc_j$. Now having the values in the overlapping domain we update $f_{LB,j}$ for the velocities $\bc_j$ directed from the overlapping domain into the interior of the LB domain.


The second step consists of the evaluation of the LB   distribution for the lattice velocities $\boldsymbol{c}_j$ such that $(\boldsymbol{c}_j,\mathbf{e})<0$ , where $\mathbf{e}$ is the outer normal to overlapping domain.  We evaluate the moments $a,a_{\alpha},a_{\alpha\beta},
a_{\alpha\beta\gamma}$ and finally update again the Grad VDF in the overlapping domain. The coefficients $a,a_{\alpha},a_{\alpha\beta},
a_{\alpha\beta\gamma}$ are calculated using the formulas
$$
a=\sum_{j=1}^N f_{LB,j}, \quad a_{\alpha}=\sum_{j=1}^N f_{LB,j}H_{\alpha}(\bc_j), \quad a_{\alpha\beta}=\sum_{j=1}^N f_{LB,j}H_{\alpha\beta}(\bc_j),
\quad a_{\alpha\beta\gamma}=\sum_{j=1}^N f_{LB,j}H_{\alpha\beta\gamma}(\bc_j).
$$
Now we are ready derive the DV VDF in the DV and LB overlapping domain. This can be made by a simple
discretization of the Grad VDFs at the nodes of the DV scheme. Finally, we evaluate the DV VDF for the all velocities $(\bxi_j,\mathbf{e}) \leq 0$
in the interior of the DV spatial domain.

The described mapping method can be generalized for the LB models which are not derived on the basis of the Gauss--Hermite quadratures.
We assume that after the regularization procedure~\cite{Latt2006, Chen2006} and~\cite{Zhang2006, Mont2015, Mattila2017}
the non-equilibrium part of LB VDF will be projected in a finite-dimensional velocity space with a basis spanned by Hermite polynomials.
Then the equivalence between the calculated LB distribution and
the expansion of the Grad type can be achieved; therefore, the proposed mapping method can be applied.

\section{Numerical method}\label{sec:numerics}

\subsection{Discrete-velocity approximation}\label{sec:numerics:dv}

The VDF can be represented as a weighted sum
\begin{equation}\label{eq:discrete_velocity}
    f = \sum_j w_j f_j(\bx,t)\delta(\bxi-\bxi_j),
\end{equation}
where \(\delta(\bxi)\) is the Dirac delta function in the velocity space.

%%% quadratures in velocity space
Under the DV formulation, an arbitrary moment \(\phi(\bxi,t)\) from \(f(\bx,\bxi,t)\) is approximated as
\begin{equation}\label{eq:cubature}
    \int \phi f\dxi = \sum_j w_j \phi(\bxi_j) f_j, \quad f_j = f(\bxi_j)
\end{equation}
where \(\bxi_j\) and \(w_j\) are fixed discrete velocities and weights.
It is convenient to deal with weighted values \(\hat{f}_j = w_jf_j\).
The evolution of \(\hat{f}_j\) is governed by the system of partial differential equations
\begin{equation}\label{eq:dvm}
    \pder[\hat{f}_j]{t} + \bxi_j\pder[\hat{f}_j]{\bx} = J(\hat{f}_j),
\end{equation}
which is called the discrete-velocity (DV) model of~\eqref{eq:bgk}~\cite{Cabannes1980}.
Here $J$ is the collisional operator.

%%% conservative and entropic models
It is important for a DV model~\eqref{eq:dvm} to preserve conservation and entropy properties
of the continuous kinetic equation~\eqref{eq:bgk}.
For the BGK model
\begin{equation}\label{eq:dvm-bgk}
    J(\hat{f}_j) = \frac1\tau\br{\equil{\hat{f}}_j-\hat{f}_j},
\end{equation}
it can be accomplished when the discrete equilibrium function \(\equil{\hat{f}}_j\)
is defined from the minimum entropy principle~\cite{Mieussens2000}:
\begin{equation}\label{eq:equilibrium-bgk}
   \equil{f}_j = \exp(\beta_r\psi_{j r}), \quad
   \psi_{j r} = \transpose{\br{1,\bxia, \xi_j^2}},
\end{equation}
where \(\beta_r\in\mathbb{R}^5\) is unique solution of
\begin{equation}\label{eq:beta}
   \sum_j\psi_{j r}\br{\equil{\hat{f}}_j - \hat{f}_j} = 0.
\end{equation}

%%% DV method
Let the molecular velocities \(\bxi_j \) be restricted to a Cartesian lattice \(X\)
with uniform spacing \(c\), called the lattice speed.
The classical DV method of solving~\eqref{eq:bgk} is based on such approximations \(J(\hat{f}_j)\)
that are consistent with \(J(f)\) when \(c\) goes to zero~\cite{Aristov2001}.
Due to exponential decay of the VDF, the given accuracy can be achieved
by cutting off all velocities that satisfy condition \(|\bxi_j| > \xi^{(\mathrm{cut})}\) from \(X\).

%%% LB method
A set of velocities with the corresponding weights \(\Set{(\bxi_j,w_j)}{j=1,\dots,Q}\)
is called the quadrature rule~\cite{Stroud1971}.
A common notation D\(n\)Q\(m\) means \(D=n\) and \(Q=m\).
Hereinafter, a quadrature rule, together with the discrete operator in form~\eqref{eq:dvm-bgk},
is referred as the lattice-BGK (LBGK) model.
When the VDF is close to equilibrium, it can be acceptably approximated using quadratures with small number \(Q\).
LBGK models are capable of reproducing low-order polynomial moments of the VDF accurately and,
therefore, describing a fluid-dynamic behavior of a gas, including that beyond the Navier--Stokes level.

%%% Difference between DV and LB
Within the introduced terminology, the only difference between the DV and LB methods is an ultimate goal.
The former one strives to capture kinetic properties of highly nonequilibrium flows and, therefore,
forced to have a quite large dimension of the approximation space \(Q\).
The latter one, on the contrary, is based on the assumption of a slightly perturbed equilibrium and, therefore,
tends to describe it in the most efficient way.

%%% Gauss--Hermite
%In the present paper, we employ LBGK models based on the %projection of the VDF onto Hermite basis~\cite{Shan2006}:
%\begin{multline}\label{eq:gauss-hermite}
%    \equil{f}_\alpha = \rho\Bigg\{ 1 + 2\xiai v_i + %\overbrace{
%        2\br{\xiai v_i}^2 - v_i^2 + (T-1)\br{\xiai^2 - %\frac{D}2}
%    }^\text{second order} + \\ \underbrace{
%        \frac{2\xiaj v_j}3\left[ 2\br{\xiai v_i}^2 - 3v_i^2 %+ 3(T-1)\br{\xiai^2 - 1 - \frac{D}2}\right]
%    }_\text{third order} + \cdots \Bigg\}.
%\end{multline}
%Truncating of~\eqref{eq:gauss-hermite} compromises the %positivity condition and,
%therefore, these LBGK models are not entropic, but the %conservation properties are preserved.

\subsection{Time-integration method}\label{sec:numerics:splitting}

%%% Splitting scheme
For the present study, we start from the simplest numerical algorithm providing the second-order accuracy
for both time and physical coordinates.
Equation~\eqref{eq:bgk} is solved by the symmetric Strang's splitting scheme~\cite{Bobylev2001}
\begin{equation}\label{eq:Strang}
    S^{\Delta{t}}_{A+B}(f_0) = S^{\Delta{t}/2}_A \br{S^{\Delta{t}}_B \br{S^{\Delta{t}/2}_A(f_0)} } + \OO{\Delta{t}^3},
\end{equation}
where \(A(f) = -\xi_i\Pder[f]{x_i}\), \(B(f) = J(f)/k\), \(\Delta{t}\) is the time step.
\(S^t_P (f_0)\) denotes the solution of the Cauchy problem
\begin{equation}\label{eq:Cauchy}
    \pder[f]{t} = P(f), \quad f|_{t=0} = f_0.
\end{equation}

%%% Space-homogeneous
Important implication of the splitting procedure is that the space-homogeneous BGK equation
\begin{equation}\label{eq:bgk_homogeneous}
    \pder[f]{t} = \frac1\tau \br{\equil{f}-f}
\end{equation}
has the exact solution
\begin{equation}\label{eq:bgk_exact}
    f(t) = \equil{f} + \br{f(t_0)-\equil{f}}\exp\br{-\frac{t-t_0}\tau}.
\end{equation}
Moreover, generalization of this algorithm to the original Boltzmann equation is straightforward.

%%% Steady-state solution
To find a steady-state solution of the boundary-value problem,
the time-marching process is started from some initial approximation
and continues until the convergence criterion is met.

\subsection{Finite-volume formulation}\label{sec:numerics:fv}

For the sake of simplicity, we consider a one-dimensional physical space.
The transport equation
\begin{equation}\label{eq:transport}
    \pder[f]{t} + \xi_1\pder[f]{x_1} = 0
\end{equation}
is approximated by the finite-volume (FV) method:
\begin{equation}\label{eq:finite_volume}
    f^{n+1}_m = f^n_m - \frac{\Delta{t}}{\Delta{x_m}}\br{F^n_{m+1/2}-F^n_{m-1/2}}, \quad
    m = 1,\dots,M, \quad n\in\mathbb{N},
\end{equation}
where \(\Delta{x_m}\) is the width of \(m\) cell in the physical space,
\begin{equation}\label{eq:vdf_fv}
    f^n_m(\bxi) = f\br{n\Delta{t}, \frac{\Delta{x_m}}2 + \sum_{k=1}^{m-1}\Delta{x_k}, \bxi}.
\end{equation}
For \(\xi_1>0\), the internal fluxes can be written in the following form:
\begin{equation}\label{eq:internal_fluxes}
    F_{m+1/2}^n = \xi_1\br{ f_m^n + \frac{1-\gamma}2\overline{\Delta{f_m^n}}},
    \quad \gamma = \frac{\xi_1\Delta{t}}{\Delta{x_m}}, \quad m = 1,\dots,M.
\end{equation}
These fluxes are calculated by the second-order total variation diminishing (TVD) scheme,
e.g., with the monotonized central (MC) slope limiter
\begin{equation}\label{eq:limiter}
    \overline{\Delta{f_m^n}} = \begin{cases}\min\br{
         2\frac{|D_-|}{h_-}, \frac12\frac{|D_-+D_+|}{h_-+h_+}, 2\frac{|D_+|}{h_+}
    }\Delta{x_m}, \quad D_+D_- > 0, \\
    0, \quad D_+D_- \leq 0,
    \end{cases}
\end{equation}
where
\begin{equation}\label{eq:differences}
    D_\pm = \pm\br{f_{m\pm1}^n - f_m^n}, \quad h_\pm = \frac{\Delta{x_{m\pm1}} + \Delta{x_m}}2.
\end{equation}
The last flux \(F_{M+1/2}^n\) is calculated based on the linear extrapolation of the solution for the ghost cell:
\begin{equation}\label{eq:last_ghost}
    f_{M+1}^n = 2f_M^n - f_{M-1}^n.
\end{equation}
Note that sharp variations (in physical space) of solution can occur even for nearly incompressible flow,
especially for large \(|\bxi|\).

%%% Boundary conditions
The diffuse-reflection boundary condition~\eqref{eq:diffuse}, e.g. at \(x=0\),
is introduced through the first flux and ghost cell:
\begin{gather}
    F_{1/2}^n(\bxia) = \displaystyle\xi_1\frac{\sum_{\xi'_{j1}<0}F_{m+1/2}^n(\bxia')}
        {\sum_{\xi'_{j1}<0}\xi'_{j1}\equil{f}(\bxi'_j,1,\bv_B,T_B)}
        \equil{f}(\bxi_j, 1, \bv_B, T_B) \quad (\xi_{j1}>0), \label{eq:first_flux}\\
    f_0^n(\bxia) = \displaystyle\frac{\sum_{\xi'_{j1}<0}\xi'_{j1}f_1^n(\bxia')}
        {\sum_{\xi'_{j1}<0}\xi'_{j1}\equil{f}(\bxi'_j,1,\bv_B,T_B)}
        \equil{f}(\bxi_j, 1, \bv_B, T_B) \quad (\xi_{j1}>0). \label{eq:first_ghost}
\end{gather}
This implementation yields the second-order accuracy along with conservation of mass.
For \(\xi_1<0\), all expressions are analogous.

%%% Why half-integer lattice?
The boundary conditions also dictate a way of discretization in the velocity space.
With respect to the origin of the velocity coordinates, only two types of lattices are symmetric~\cite{Inamuro1990}:
integer \(\br{\xiai/c} \in \mathbb{Z}^3\) and half-integer \(\br{\xiai/c + e_i/2} \in \mathbb{Z}^3\),
where \(e_i\) is the corresponding orthonormal basis.
For the considered boundary condition at \(x=0\), there is a zero-measure set of velocities
\(\Set{\bxi\in\mathbb{R}^3}{\xi_1=0}\), called tangential.
These velocities are immune to the diffuse reflection.
In contrast, the integer lattice contains a substantial subset of tangential velocities.
Therefore, to avoid an additional discretization error, the half-integer lattice should be employed.

%%% Diffuse reflection for LB
In the same manner, LB cubatures without tangential velocities are preferable to the classical ones.
Moreover, LB models can be augmented by special groups of velocities to approximate
the diffuse-reflection boundary condition more accurately~\cite{Feuchter2016}.
These models ensure vanishing errors of the relevant half-space integrals.
The Gauss--Laguerre quadratures provides another way to reproduce the Maxwell half-moments exactly~\cite{Ambrus2014, Ambrus2016}.

\subsection{Coupling algorithm}\label{sec:numerics:coupling}

%%% Homogeneous domain decomposition problem

The mapping approach presented in Section~\ref{sec:mapping} can be implemented within the FV framework.
Divide our computational domain in the physical space into subdomains, each employing its own DV model.
The coupling conditions at the interface between subdomains can be considered as virtual boundary conditions.
They are symmetric due to unified formulation in the physical space.

%%% Projection and reconstruction procedures
The concept of ghost cells suggests the simplest (from the algorithmic point of view) coupling strategy.
If the interface between subdomains lies in the near-continuum region,
it is admissible to exchange information only within a Hilbert subspace \(\mathcal{H}\)
spanned by the truncated Hermite polynomials.
Then, all that we need is to supplement each DV model with a mapping to this subspace.

%%% Conservative scheme
The proposed mapping procedure does not violate the conservation properties of the FV scheme,
because all moments required for the equilibrium function are calculated exactly.
However, the FV scheme actually deals separately with velocities
directed in the opposite half-spaces with respect to the interface.
For this reason, mass, momentum, and energy fluxes across the coupling interface
are turned out to differ slightly for each DV model.
In the present paper, we employ the polynomial correction (like in~\cite{Aristov1980}):
\begin{equation}\label{eq:poly_correction}
    \bar{F}^{(1)}_j = F^{(1)}_j(1+\gamma_r\psi_{j r}), \quad
    \sum_{j=1}^{Q^{(1)}} \bar{F}^{(1)}_j\psi_{j r} = \sum_{j=1}^{Q^{(2)}} F^{(2)}_j\psi_{j r},
\end{equation}
where \(F^{(s)}\) and \(Q^{(s)}\) are the initial flux and number of velocities of \(s\) model, respectively,
\(\bar{F}^{(1)}\) is the corrected flux, \(\psi_{j r}\) is defined in~\eqref{eq:beta}.
In practice, each component of \(\gamma_r\in\mathbb{R}^5\) is significantly less than unity;
therefore, the positivity is also preserved.

%%% 1D example
Finally, let us return to the one-dimensional example outlined in sec.~\ref{sec:numerics:fv}
and suppose that \(x=0\) is our interface.
In order to use~\eqref{eq:internal_fluxes}, the VDF should be reconstructed in the ghost cells.
In case of the second-order TVD scheme, \(f_{-1}^n\) is used for all \(\bxia\) and, additionally,
\(f_{-2}^n\) is required when \(\xi_{j1}>0\).
In case of the first-order scheme, \(f_{-1}^n\) and only for \(\xi_{j1}>0\) is sufficient.

\section{Results and discussions}\label{sec:results}

\begin{figure}
    \centering
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{dvm}
        \caption{DV method}
        \label{fig:dvm}
    \end{subfigure}%
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{d3q19}
        \caption{LB method: D3Q19}
        \label{fig:d3q19}
    \end{subfigure}\\
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{d3q121}
        \caption{LB method: D3Q121}
        \label{fig:d3q121}
    \end{subfigure}%
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{d3v96}
        \caption{LB method: D3Q96}
        \label{fig:d3q96}
    \end{subfigure}
    \caption{
        Numerical solution of the Couette-flow problem for $\Kn=0.1$ obtained by pure DV or LB methods.
        The black lines are the high-accuracy solution of the BGK model.
        The black boxes correspond to the tabulated solutions~\cite{Luo2015, Luo2016}.
    }\label{fig:pure}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{hyb-d3q19}
        \caption{hybrid (DV and D3Q19)}
        \label{fig:hyb:d3q19}
    \end{subfigure}%
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{hyb-d3v96}
        \caption{hybrid (DV and D3Q96)}
        \label{fig:hyb:d3q96}
    \end{subfigure}\\
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{hyb-d3q19-narrow}
        \caption{hybrid (DV and D3Q19)}
        \label{fig:hyb:d3q19-narrow}
    \end{subfigure}%
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{hyb-d3q19-wide}
        \caption{hybrid (DV and D3Q19)}
        \label{fig:hyb:d3q19-wide}
    \end{subfigure}
    \caption{
        Numerical solution of the Couette-flow problem for $\Kn=0.1$ obtained by the proposed hybrid method.
        The black lines are the high-accuracy solution of the BGK model.
        The black boxes correspond to the tabulated solutions~\cite{Luo2015, Luo2016}.
        The coupling interface is located at a distance of $0.6$ (\subref{fig:hyb:d3q19-narrow}),
        $1.2$ (\subref{fig:hyb:d3q19}, \subref{fig:hyb:d3q96}),
        and $2.4$ (\subref{fig:hyb:d3q19-wide}) mean free path from the plate.
    }\label{fig:hybrid}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{norms-dvm}
        \caption{DV method}
        \label{fig:norms:dvm}
    \end{subfigure}%
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{norms-d3v96}
        \caption{D3Q96}
        \label{fig:norms:d3q96}
    \end{subfigure}\\
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{norms-hyb-d3q19}
        \caption{DV and D3Q19}
        \label{fig:norms:d3q19-hyb}
    \end{subfigure}%
    \begin{subfigure}[b]{0.5\textwidth}
        \includegraphics[width=\textwidth]{norms-hyb-d3v96}
        \caption{DV and D3Q96}
        \label{fig:norms:d3q96-hyb}
    \end{subfigure}
    \caption{
        Quantities that can serve as a equilibrium breakdown parameter. \(L^p\) norm means \(\|f-f^{\mathrm{NSF}}\|_{L^p}/\|f\|\).
    }\label{fig:norms}
\end{figure}

%%% Couette-flow problem
In the present paper, we apply the proposed hybrid method for the plane Couette-flow problem,
where a gas is placed between the two parallel plates, which have non-zero relative velocity.
A highly nonequlibrium gas in the Knudsen layer is described using the BGK equation, while the LB model is employed for the internal zone.
For the BGK model, this problem can be reduced to a one-dimensional integral equation,
which has been solved with high accuracy in~\cite{Luo2015, Luo2016}.

%%% Formulation of the problem, grids
Let plates be placed at $y = \pm 1/2$ with constant temperature $T = 1$ and velocities ($\pm\Delta v/2,0,0$), where $\Delta v=0.02$.
A complete diffuse reflection are assumed at the plates.
The average density is equal to unity $\int_{-1/2}^{1/2}\rho dy=1$.
The physical space $0 < y < 1/2$ is divided into $N_x = 40$ nonuniform cells refined near $y = 1/2$.
For the DV approximation, the uniform Cartesian lattice with $c=0.5$ is cut off by the sphere with radius $\xi^{(\mathrm{cut})}=4$.
The total number of points is $N_\xi=2176$.

%%% Pure DVM results
The numerical results for the pure DV and LB methods are showed in Fig.~\ref{fig:pure}.
There is a small discrepancy between the DV and benchmark profiles.
Mainly, this is due to inaccurate approximation of sharp variations of the VDF near plane \(\xi_y=0\).
They can be efficiently captured by the DV method by employing significantly nonuniform velocity grid
with local refinement~\cite{Ohwada1990, Rogozin2016}.

%%% Pure LBM results
As for LB method, in the present paper, we consider the classical 5-order D3Q19 model, 9-order D3Q121 model~\cite{Shan2010},
and special 7-order D3Q96 model developed for the boundary-value problems driven by the diffuse boundary condition~\cite{Feuchter2016}.
Obviously, the LB models are unable to describe the Knudsen layer accurately.
In particular, models of the Navier--Stokes level do not capture it due to lack of additional degrees of freedom (Fig.~\ref{fig:d3q19}).
Increasing order of the LB model practically does not reduce the approximation error (Fig.~\ref{fig:d3q121}).
However, the LB models augmented by special groups of velocities are capable to reproduce the Knudsen to some extent (Fig.~\ref{fig:d3q96}).

%%% Heat flux
Ability to capture kinetic effects arising from the diffuse-reflection boundary condition
is clearly observed from the profile of the longitudinal heat flux \(q_x\).
The D3Q19 model does not describe the third-order moments of the VDF.
Its heat flux is \(\OO{\Delta v^3}\) and tightly connected with the stress tensor and velocity, but is not zero exactly in Fig.~\ref{fig:d3q19}.
D3Q121 describes the heat flux in the continuum zone most accurately, while the D3Q96 profile is quite close to the exact one in the Knudsen layer.

%%% Hybrid results
The numerical results for the hybrid schemes are shown in Fig.~\ref{fig:hybrid}.
\(v_x\) and \(p_{xy}\) are close to the exact solution;
\(q_x\) resembles the pure DV result only in the kinetic region (the DV part of the hybrid solution).
Since the proposed mapping scheme does not preserve monotonicity,
there are small oscillations in the buffer zone and they are particularly noticeable for \(q_x\).
The amplitude of these oscillations is proportional to the non-equilibrium part of the VDF
and decreases exponentially as the coupling interface moves away from \(y=1/2\).

%%% Breakdown criteria
A multiscale hybrid method based on the domain decomposition procedure should be supplied with the so-called equilibrium breakdown criteria.
\(q_x\) appears only in the Knudsen layer and, therefore, can serve as an equilibrium breakdown parameter
for the investigated Couette-flow problem, but not in the general case.
Criteria based on deviation of the VDF from the truncated Chapman--Enskog expansion is natural for kinetic schemes.
Deviation from the Navier--Stokes--Fourier (NSF) order of approximation~\cite{Zhang2014}
\begin{equation}\label{eq:NSF}
    f^{\mathrm{NSF}}_j = \equil{f}_j\br{
        1 + \frac{\cai\caj P_{\alpha\beta}}{2pT} + \frac{2\cai q_\alpha}{5pT}\br{\frac{\caj^2}{2T} - \frac52} },
\end{equation}
where \(P_{\alpha\beta} = p_{\alpha\beta} - \rho T\delta_{\alpha\beta}\) and \(\cai = \xiai - v_\alpha\),
is demonstrated in Fig.~\ref{fig:norms} for the following norms in the discrete velocity space:
\begin{equation}\label{eq:norms}
    \|f\|_{L^p} = \sum_j \br{|f_j|^p}^{1/p}.
\end{equation}
The D3Q19 model produce an almost constant profile (Fig.~\ref{fig:norms:d3q19-hyb}), since it describes nothing beyond the NSF level.
The D3Q96 profile (Fig.~\ref{fig:norms:d3q96}) is close to the DV one (Fig.~\ref{fig:norms:dvm}),
which indirectly indicates that this LB model gives a good approximation for the Couette-flow problem;
however, deviation in \(L^\infty\) norm significantly exceeds the others in Fig.~\ref{fig:norms:d3q96}.
This fact means that D3Q96, despite inability to capture sharp variations of the VDF near the boundary,
is capable to capture macroscopic dynamics with quite high accuracy.

\begin{figure}
    \centering
    \includegraphics{acceleration}
    \caption{
        Computational speed-up yielded by the hybrid method for different CPUs and operational systems.
        $N_0$ is the number of cells in the kinetic zone, $10N_0$ is the number of cells in the bulk region,
        $t_\mathrm{DV}$ and $t_\mathrm{hyb}$ are the total CPU times elapsed by the DV and hybrid methods, respectively.
    }\label{fig:speed-up}
\end{figure}

%%% Efficiency
Finally, let us touch upon the efficiency of the proposed hybrid scheme.
The computational speed-up with respect to the pure DV scheme is shown in Fig.~\ref{fig:speed-up} as a ratio of the corresponding CPU times,
while the ratio of cells in the kinetic and bulk regions remains constant.
One can see that efficiency of the hybrid method achieves the optimum value when number of cells in the kinetic region is more than $10^2$.
Note that the asymptotic speed-up can be slightly higher than the optimum one (12--13 versus 11 in Fig.~\ref{fig:speed-up}).
It is mainly due to memory saving, which results in fewer cache misses.

\section{Conclusion}\label{sec:summary}

%%% What have we done?
In the paper, we have presented a new algorithm of coupling the discrete-velocity numerical solutions of the BGK kinetic equation.
The mapping method is based on the Hermite expansion of the VDF.
For continuum region, we have employed several Gauss--Hermite LB models with different number of discrete velocities, ranging from 19 to 121.
Additional correction procedures have been applied to ensure conservative properties of the hybrid algorithm.
The influence of the breakdown criterion to accuracy and efficiency has been studied.

%%% Adaptive mesh in velocity space
The following problems for the further study can be addressed.
Significant number of discrete velocities used for approximation the VDF is somewhat overkill,
since the highest moments are turned out to be unimportant for many flows.
Therefore, adaptation of the DV set according to the local flow regime provides room for improving efficiency of numerical methods
and can serve as a foundation of hybrid schemes for compressible flows.
This approach is similar to the adaptive schemes in velocity space~\cite{Aristov1977, Kolobov2013, Baranger2014}.

%%% Other LB models
The other LB models, e.g., for supersonic flows, compressible and thermal flows~\cite{Chen2010, Frapolli2015, Frapolli2016},
can be incorporated in the proposed hybrid method.
The entropic models are promising due to their enhanced stability for low viscosities (large Reynolds numbers).

\section*{Acknowledgements}

This work was supported by the Russian Foundation for Basic Research, Grant 18-01-00899.

\section*{References}

\bibliography{dvm-lbm}

\end{document}

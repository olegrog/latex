PROJECT=couette_heat
FIGURES=tikz/geometry.pdf couette/graph.pdf couette/flow.pdf couette/qflow.pdf heat/graph.pdf error/error.pdf
SOURCES=$(PROJECT).tex $(PROJECT).bib $(FIGURES)
SHELL=/bin/bash

all: $(PROJECT).pdf

tikz/geometry.pdf: tikz/geometry.tex
	cd tikz && latex geometry

heat/graph.pdf:	heat/qflow.txt heat/sone.txt heat/bgkw.txt heat/graph.sh
	cd heat && ./graph.sh && pdflatex graph

error/error.pdf:	error/data.txt error/error.sh
	cd error && ./error.sh && pdflatex error

couette/qflow.pdf:	couette/data.txt couette/sone.txt couette/qflow.sh
	cd couette && ./qflow.sh && pdflatex qflow

couette/flow.pdf:	couette/data.txt couette/sone.txt couette/flow.sh
	cd couette && ./flow.sh && pdflatex flow

couette/graph.pdf:	couette/data.txt couette/sone.txt couette/bgkw.txt couette/graph.sh
	cd couette && ./graph.sh && pdflatex graph

$(PROJECT).pdf: $(SOURCES) 
	latex $(PROJECT)
	biber $(PROJECT)
	latex $(PROJECT)

clean:
	rm -f $(PROJECT).{aux,toc,log,out,run.xml,bbl,bcf,blg,pdf}
	rm -f {couette,heat,error}/{graph,flow,qflow,error}{.tex,.pdf,.aux,.log,-inc*}
	rm -f {couette,error,heat}/fit.log       # generated by gnuplot fitting


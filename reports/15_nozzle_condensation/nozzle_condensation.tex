\documentclass{article}
\usepackage[english]{babel}
\usepackage{csquotes}

%%% Functional packages
\usepackage{amsmath, amssymb, amsthm}
\usepackage{physics, siunitx}
\usepackage{multirow}

%%% Configuration packages
%\usepackage{fullpage}

\usepackage[
    pdfusetitle,
    colorlinks
]{hyperref}

\usepackage[
    backend=biber,
    style=authoryear,
    autolang=other,
    sorting=none,
    mincrossrefs=100, % do not add parent collections
]{biblatex}
%\addbibresource{nozzle_condensation.bib}

\title{A condensation flow in supersonic nozzles}
\author{Oleg Rogozin}

%%% Problem-specific aliases
\newcommand{\vap}{\text{v}}
\newcommand{\ine}{\text{i}}
\newcommand{\con}{\text{c}}
\newcommand{\eq}{\text{eq}}
\newcommand{\crit}[2][]{#2_\text{cr#1}}
\newcommand{\Hill}{\text{H}}

%%% Bold symbols
\newcommand{\bv}{\vb*{v}}
\newcommand{\bn}{\vu*{n}}
\newcommand{\bx}{\vb*{x}}

\begin{document}
\maketitle

\section{Gas dynamics}

%%% Governing equations
The steady-state behavior of an inviscid gas in the presence of phase transition
can be described by the diabatic flow equations:
\begin{gather}
    \div(\rho\bv) = 0, \label{eq:rho}\\
    \div(\rho\bv\bv) + \grad{p} = 0, \label{eq:v}\\
    \div(\rho\bv h_0) = \dot{q}, \label{eq:h}
\end{gather}
where $\rho$ is the density (\si{\kg\per\cubic\m}), $\bv$ is the velocity (\si{\m\per\s}),
$p$ is the pressure (\si{\Pa}), $\dot{q}$ is the volumetric heat source (\si{\J\per\cubic\m\per\s}), and
\begin{equation}\label{eq:h0}
    h_0 = c_pT + \frac{|\bv|^2}{2}
\end{equation}
is the stagnation enthalpy (\si{\J\per\kg}). In~\eqref{eq:h0},
$c_p$ is the specific heat capacity at constant pressure (\si{\J\per\kg\per\K}), $T$ is the temperature (\si{\K}).

%%% 1D geometry
Let us consider a one-dimensional compressible flow in a nozzle with a specified cross section $A(x)$.
Assuming that $\bv = (v,0,0)$ and integrating Eqs.~\eqref{eq:rho}--\eqref{eq:h} over the cross section, we obtain
\begin{gather}
    \dv{\dot{m}}{x} = 0, \label{eq:continuity}\\
    \dv{x}(p + \rho v^2) = \frac{\dot{m}v}{A^2}\dv{A}{x}, \label{eq:momentum}\\
    \dv{x}(c_pT + \frac{v^2}{2}) = \frac{A\dot{q}}{\dot{m}}, \label{eq:energy}
\end{gather}
where $\dot{m} = \rho Av$ is the constant mass flow rate through the nozzle (\si{\kg\per\s}).

%%% Equation of state
The system of governing equations is closed by the equation of state
\begin{equation}\label{eq:eos}
    p = \frac{\rho RT}{\bar{M}},
\end{equation}
where $\bar{M}$ is average molar mass of the mixture of ideal gases (\si{\kg\per\mol}),
$R$ is the universal gas constant ($= \SI{8.3145}{\J\per\mol\per\K}$).

%%% Mach number
Next, it is convenient to deal with the Mach number
\begin{equation}\label{eq:Mach}
    M = \qty(\frac{\bar{M}v^2}{\gamma RT})^{1/2},
\end{equation}
where
\begin{equation}\label{eq:gamma}
    \gamma = \qty(1-\frac{R}{c_p\bar{M}})^{-1}
\end{equation}
is the heat capacity ratio.
Using the following relations:
\begin{equation*}
    \rho v^2 = \gamma p M^2, \quad v^2 = (\gamma-1)c_pT M^2,
\end{equation*}
Eqs.~\eqref{eq:momentum} and~\eqref{eq:energy} take the form
\begin{gather}
    \dv{x}(p\qty(1 + \gamma M^2)) = \frac{\gamma p M^2}{A}\dv{A}{x}, \label{eq:momentum2}\\
    \dv{x}(c_pT\qty(1 + \frac{\gamma-1}{2}M^2)) = \frac{A\dot{q}}{\dot{m}}, \label{eq:energy2}
\end{gather}
and mass flow rate
\begin{equation}\label{eq:dotm}
    \dot{m} = \frac{\gamma pMA}{((\gamma-1)c_pT)^{1/2}}.
\end{equation}

\section{Gas properties}

%%% Mixture
Let us consider a binary mixture of two gases.
One of them is a vapor that can condense, while the other is inert.
Thus, $\rho = \rho_\ine + \rho_\vap + \rho_\con$.
Let $w_0$ be the initial vapor mass fraction, then
\begin{equation}\label{eq:rhoM}
    \frac{\rho_\ine}{\rho} = 1-w_0, \quad \frac{\rho_\vap}{\rho} = w_0-g, \quad \frac{\rho_\con}{\rho} = g,
\end{equation}
where $g$ is the condensate mass fraction.
The specific heat capacity of the mixture is calculated according to mass fractions as follows:
\begin{equation}\label{eq:c_p}
    c_p = (1-w_0)c_{p\ine} + (w_0-g)c_{p\vap} + gc_{p\con},
\end{equation}
Similarly,
\begin{equation}\label{eq:M}
    \frac1{\bar{M}} = \frac{1-w_0}{M_\ine} + \frac{w_0-g}{M_\vap},
\end{equation}
where the contribution of the condensate phase is zero.

\section{Condensation}

%%% Moment equations
The gas dynamic equations are augmented by the following moment equations:
\begin{equation}\label{eq:mu_k}
    \div(\mu_k\bv) = \dot{\mu}_k \quad (k=0,1,2,\dots),
\end{equation}
where $\mu_k$ is the $k$th moment of the particle distribution function ($\si{\m}^{k-3}$), and
\begin{equation}\label{eq:dotmu}
    \dot\mu_k = \begin{cases}
        J &\text{if } k=0,\\
        \crit{r}^{k}J + k\dot{r}(r_\Hill)\mu_{k-1} &\text{if } k>1.
    \end{cases}
\end{equation}
Here, $J$ is the nucleation rate (\si{\per\cubic\m\per\s}),
$\dot{r}$ is the growth rate function (\si{\m\per\s}) of droplet radius $r$,
and $r_\Hill=\sqrt{\mu_2/\mu_0}$ is the surface-averaged radius (\si{\m}).
The nucleation terms in the source~\eqref{eq:dotmu} vanish, when oversaturation $S = p_\vap/p_\eq$,
which is the ratio of the vapor pressure $p_\vap = (w_0 - g)p\bar{M}/M_\vap$
to the saturated pressure $p_\eq$ at local flow temperature, is less or equal to one.
When $S>1$, new particles nucleate at a given size,
called the critical radius, $\crit{r} = \lambda_K/\ln(S)$, where
\begin{equation}\label{eq:Kelvin}
    \lambda_K = \frac{2\sigma M_\vap}{\rho_L R T}
\end{equation}
is the Kelvin length (\si{m}) and $\sigma$ is the surface tension coefficient (\si{\J\per\square\m}).

%%% Condensate-mass quantities
The heat source in the energy equation~\eqref{eq:energy2}
and the condensate mass fraction are expressed in terms of $\mu_3$ as follows:
\begin{equation}\label{eq:dotq-g}
     \dot{q} = \frac{4\pi}{3}\rho_L\dot{\mu}_3H, \quad g = \frac{4\pi}{3} \frac{\rho_L\mu_3}{\rho},
\end{equation}
where $\rho_L$ is the density of the condensed phase (\si{\kg\per\cubic\m})
and $H$ is the latent heat of condensation (\si{\J\per\kg}).

%%% Nucleation rate
According to the Hale model, nucleation rate
\begin{equation}\label{eq:J}
    J = J_{0} \exp(-\frac{16\pi}{3}\Omega^3 \frac{(\crit{T}/T-1)^3}{(\ln S)^2}) \quad (S > 1),
\end{equation}
where $J_0$ is the nucleation prefactor (\si{\per\cubic\m\per\s}),
$\Omega$ is the excess surface entropy per molecule divided by the Boltzmann constant,
and $\crit{T}$ is the critical temperature (\si{\K}).

%%% Growth rate
The isothermal growth law states that
\begin{equation}\label{eq:dotr}
    \dot{r}(r) = \frac{5\pi\alpha}{16\rho_L}
    \qty(\frac{M_\vap}{2\pi RT})^{1/2}
        \qty(p_\vap-p_\eq\exp(\frac{\lambda_K}{r})),
\end{equation}
where $\alpha$ is the condensation coefficient.

%%% 1D geometry
Finally, let us note that in the considered 1-D case the moment equations take the form
\begin{equation}\label{eq:moments}
    \dv{x}(\frac{\mu_k}{\rho}) = \frac{\dot{\mu}_kA}{\dot{m}}.
\end{equation}

\section{Dimensional analysis}

Let $L$, $p_0$, and $T_0$ be, respectively, the reference length, pressure, and temperature, and put
\begin{equation}\label{eq:reference}
    c_{p0} = \frac{R}{\bar{M}(0)}, \quad v_0 = \sqrt{c_{p0}T_0}, \quad
    \rho_0 = \frac{p_0}{v_0^2}, \quad n_0 = \frac{J_0L}{v_0}.
\end{equation}
Then, the nondimensional variables are defined as follows:
\begin{equation}\label{eq:nondimensional}
    \left.\begin{aligned}
        \hat{x} &= x/L,             &\hat{A} &= A/L^2,              &\hat{p} &= p/p_0, \\
        \hat{\rho} &= \rho/\rho_0,  &\hat{v} &= v/v_0,              &\hat{\dot{r}} &= \dot{r}/v_0 \\
        \hat{c}_p &= c_p/c_{p0},    &\hat{T} &= T/T_0,              &\hat{\dot{q}} &= \dot{q}L/p_0v_0 \\
        \hat{J} &= J/J_0,    &\crit{\hat{r}} &= \crit{r}/\lambda_K, &\hat{\mu}_k &= \mu_k/n_0\lambda_K^k.
    \end{aligned}\quad\right\}
\end{equation}
If we additionally assume that $\dot{m} = \rho_0v_0L^2$, then the governing equations take the form
\begin{gather}
    \dv{\hat{x}}(\hat{p}\qty(1 + \gamma M^2))
        = \frac{\gamma \hat{p} M^2}{\hat{A}}\dv{\hat{A}}{\hat{x}}, \label{eq:momentum3}\\
    \dv{\hat{x}}(\hat{c}_p\hat{T}\qty(1 + \frac{\gamma-1}{2}M^2))
        = \hat{A}\hat{\dot{q}}, \label{eq:energy3}\\
    \dv{\hat{x}}(\frac{\hat{\mu}_k}{\hat{\rho}}) = \hat{A}\qty(\crit{\hat{r}}^{k}\hat{J}
        + k\frac{L}{\lambda_K}\hat{\dot{r}}(\hat{r}_\Hill)\hat{\mu}_{k-1}). \label{eq:moments3}
\end{gather}
Only one dimensionless number appears, $L/\lambda_K$, which is essentially the ratio of the nozzle dimensions
to the size of nucleating particles. This multiscale parameter is included in the growth term
and, therefore, influences to the ratio of condensation rates due to growth and nucleation, respectively.

\section{Numerical analysis}

\subsection{Direct solution}

The governing equations~\eqref{eq:momentum2}--\eqref{eq:dotm} can be solved directly, which yields three quantities:
\begin{equation}\label{eq:solution1}
    y_c = \frac{(\gamma pM)^2}{(\gamma-1)c_pT}, \quad
    y_m = p\qty(1 + \gamma M^2), \quad
    y_e = c_pT\qty(1 + \frac{\gamma-1}{2}M^2).
\end{equation}
Then, the Mach number is found from the algebraic equation
\begin{equation}\label{eq:solution1}
    \qty(y_c y_e - \frac12y_m^2)\gamma^2M^4 + \qty(2y_c y_e - \frac{\gamma}{\gamma-1}y_m^2)\gamma M^2 + y_cy_e = 0.
\end{equation}
However, we have to chose the physically correct root of Eq.~\eqref{eq:solution1} manually,
which is not convenient for numerical analysis in the general case.

\subsection{Transformed equations}

Instead, the governing equations~\eqref{eq:momentum2}--\eqref{eq:dotm} can be transformed to the following:
\begin{gather}
    \frac1p\dv{p}{x} = \frac{\gamma M^2}{M^2 - 1}
        \qty( \frac1{\gamma(\gamma-1)}\dv{\gamma}{x} - \qty(3 + 2(\gamma-1)M^2)\frac1A\dv{A}{x}
            + \frac{A\dot{q}}{c_pT\dot{m}}), \label{eq:p}\\
    \dv{\gamma M^2}{x} =
        \frac{\gamma M^2}{A}\dv{A}{x} - \qty(1 + \gamma M^2)\frac1p\dv{p}{x}, \label{eq:Ma}\\
    \frac1{c_pT}\dv{c_pT}{x} = \qty(1+\frac{\gamma-1}{2}M^2)^{-1}
        \qty(\frac{A\dot{q}}{c_pT\dot{m}} - \frac{\gamma-1}{2\gamma}\dv{\gamma M^2}{x}
            - \frac{M^2}{2\gamma}\dv{\gamma}{x}), \label{eq:T}
\end{gather}
where
\begin{gather}
    \frac1\gamma\dv{\gamma}{x}
        = (1-\gamma)\qty(\frac{c_{p\con} - c_{p\vap}}{c_p} + \frac{\bar{M}}{M_\vap})\dv{g}{x}, \label{eq:gamma_prime}\\
    \dv{g}{x} = \frac{4\pi}{3}\rho_L\dv{x}(\frac{\mu_3}{\rho}). \label{eq:g_prime}
\end{gather}

%\printbibliography

\end{document}
